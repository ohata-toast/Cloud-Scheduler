# スケジュール作成
**Application Service > Cloud Scheduler > コンソール使用ガイド > スケジュール作成**


スケジュールは基本情報、対象情報、追加設定情報で構成されます。

* 基本情報：スケジュール実行のためのタイプ、周期、開始/終了日時を選択します。
* 対象情報：スケジュールが呼び出したAPI情報及びHTTPメソッド、ヘッダ、パラメータを入力します。
* 追加設定：スケジュール有効化/無効化及び再試行ポリシー(回数、間隔)を設定します。

ここでは、スケジュールを作成する手順を詳しく案内します。


## スケジュールを作成する

スケジュールを作成するには、まず、Cloud Schedulerサービスを有効にする必要があります。[プロジェクトサービス有効化ガイド](https://docs.nhncloud.com/ja/nhncloud/ja/console-guide/#_20)を参考にしてCloud Schedulerサービスを有効にしてください。

1. NHN Cloudコンソールで**Application Service > Cloud Scheduler**をクリックしてください。

1. **+スケジュール作成**をクリックしてください。

1. テンプレートを使用する場合は**使用**を選択してください。

1. 使用したいテンプレートがあれば選択してください。

1. 基本情報設定を入力した後、**次へ**をクリックしてください。
    * **名前**：作成するスケジュールの名前を入力します。最大32文字まで入力できます。 
    * **説明**：作成するスケジュールの説明を入力します。最大255文字まで入力できます。
    * **実行タイプ**:スケジュール実行タイプを選択します。実行タイプは **一回**または **繰り返し**を選択することができ、選択したタイプによって設定項目が異なります。
        * **一回**：タスクを指定した時刻に一度だけ実行します。 **実行日時**を入力します。
        * **繰り返し**：タスクを設定した時間またはスケジュール間隔で繰り返し実行します。 **Cron**と**Rate**タイプのいずれかを選択してタスク実行タイミングを設定できます。
            * **Cron式**：空白で区切られた5つのフィールドで作成します。フィールドは順番に「分、時、日、月、曜日」です。 各フィールドは次の表のように入力することができ、各フィールドの項目を区別したり、繰り返しを表示するために記号を使用することもできます。

              | フィールド | 値 | 入力可能な記号 |
              | --- | --- | --- |
              | 分 | 0~59 | `*`, `,`, `-` |
              | 時 | 0~24 | `*`, `,`, `-` |
              | 日 | 1~31 | `*`, `,`, `-` |
              | 月 | 1~12またはJAN~DEC | `*`, `,`, `-` |
              | 曜日 | 0~6またはSUN~SAT | `*`, `,`, `-` | 

            * **Rate**：一定時間間隔(分/時間/日単位)でスケジュールを実行します。最大30日(43,200分、 720時間)まで登録できます。
            
        * **開始日時**：スケジュールを開始する日付です。開始日時は必須入力項目であり、現在時刻から5分後の時刻から設定できます。
        * **終了日時**：スケジュールが終了する日付です。設定しない場合、入力した繰り返し周期でスケジュールを継続的に実行します。

1. 対象タイプを選択します。対象タイプは**直接入力**または**対象テンプレート**を選択することができ、選択したタイプによって入力する項目が異なります。
   * **直接入力**：対象情報を直接入力します。
        * **URL**:呼び出すURLを入力します。最大255文字まで入力できます。
        * **HTTPメソッド**:ドロップダウンリストをクリックしてHTTPメソッドを選択します。
        * **HTTPヘッダ**: **+ 追加**をクリックしてHTTPヘッダを入力します。 HTTPヘッダは最大20個まで追加することができ、追加した全体ヘッダサイズを合計して最大8KBまで入力できます。
        * **パラメータ**:リクエスト本文を入力します。 HTTPメソッドを **POST**, **PUT**, **PATCH**を選択するとパラメータフィールドが表示されます。入力可能なパラメータサイズは256KBです。
    * **対象テンプレート**: Cloud Schedulerが提供する対象テンプレートに従って対象情報を入力します。

1. 追加設定を完了した後、**次へ**をクリックしてください。
    * **スケジュール有効化**：スケジュールを有効化するかどうかを選択します。
    * **再試行ポリシー**：スケジュールの実行に失敗した時、再試行するように設定できます。**設定**を選択すると、**再試行間隔**と**最大再試行回数**フィールドが表示されます。
        * APIの呼び出しに失敗した場合、設定した再試行ポリシーに従ってスケジュールを再試行します。
        * API成功基準は次のとおりです。
            * NHN Cloudサービス：HTTP Response Status Codeが`200`で、`$.header.isSuccessful`の値が`true`の場合
            * 外部サービス：HTTP Response Status Codeが`2xx`
        * **再試行間隔**：失敗したスケジュールを再試行する間隔を入力します。最小1分から最大60分まで設定できます。
        * **最大再試行回数**：最大再試行回数を入力します。最大5回まで設定できます。

1. **最終確認と保存**段階で設定した情報を確認してから**スケジュール作成**をクリックしてください。

!!! tip "参考情報"
    * テンプレート機能を利用して、あらかじめ設定しておいた情報を素早く入力できます。 [テンプレート管理](manage-schedule-template)を参照してください。
    * Cron式は5つのフィールドで作成し、フィールドは順番に「分、時、日、月、曜日」です。
    * スムーズなスケジュール実行のために、開始日時を現在時刻より 5分以上余裕を持って設定してください。
    * 作成したスケジュールが反映されるまでに最大30秒かかる場合があります。そのため、その間、有効化/無効化を含むスケジュール内容の変更に失敗する可能性があります。
    
    
!!! danger "注意"
    * Cron式は韓国標準時(UTC+09:00)基準で動作します。例えば、 '0 9 \* \* \*'と入力すると、毎日韓国時間で午前9時に作業が実行されます。
    * 繰り返しタイプを**Rate**に選択した場合、スケジュール実行は**開始日時**と**Rate**値によって変更されることがあります。[Rateスケジュールの作動方式](create-schedule/#rate)および[スケジュール実行例](create-schedule/#_3)を参考に正しく設定してください。   
   
## Rateスケジュールの作動方式

Rateスケジュールは、設定した時間間隔に 従ってスケジュール実行します。
ここではRateスケジュールの作動方式を説明します。

* 初回開始日時：Rateスケジュールが最初に開始される日付は、ユーザーが設定した**開始日時**です。
* スケジュール実行時間：Rateスケジュールの実行時間は、**開始日時**を基準にユーザーが設定した**Rate**間隔ごとに実行されます。これは無効化後、有効にした場合も同様に適用されます。
* Rate変更時：Rateが変更されると、変更されたRate間隔に従ってスケジュールが実行されます。ただし、直前の実行時間に関係なく、**開始日時**を基準に変更された**Rate**間隔で実行されます。

## スケジュール実行例

スケジュールが実行される時刻は、設定した開始日時と終了日時、そしてどのようなスケジュールタイプで入力したかによって異なります。
ここでは、ユーザーの理解を助けるために、同じ開始日時と終了日時の場合、Cron、Rateスケジュールタイプでのスケジュール実行例を示します。

!!! tip 「参考情報」
   スケジュール実行例の日付データは韓国標準時(UTC+09:00)基準です。
    
    
* **開始日時**：2024-01-05 00:00:00
* **終了日時**：2024-01-08 01:00:00
* Cronスケジュールの場合
    * **Cron式**：0 12 \* \* \* (毎日昼12時実行)
    * 最初のスケジュール実行時間
        * 2024-01-05 12:00:00
    * 最後のスケジュール実行時間
        * 2024-01-07 12:00:00
* Rateスケジュールの場合
* 一般的な状況
        * **Rate**：12時間ごとに実行
        * 最初のスケジュール実行時間
            * 2024-01-05 00:00:00
        * 最後のスケジュール実行時間
            * 2024-01-08 00:00:00
    * スケジュールを無効にした後、有効にする
        * **Rate**：3時間ごとに実行
        * 1次実行
            * 2024-01-05 00:00:00
        * 2次実行
            * 2024-01-05 03:00:00
        * スケジュール無効化
            * 2024-01-05 04:00:00
        * スケジュール有効化
            * 2024-01-05 10:00:00
        * 3次実行
            * 2024-01-05 12:00:00
        * 4次実行
            * 2024-01-05 15:00:00
    * **Rate**変更
        * **Rate**：3時間ごとに実行
        * 1次実行
            * 2024-01-05 00:00:00
        * 2次実行
            * 2024-01-05 03:00:00
        * **Rate**：4時間ごとの実行に変更
            * 2024-01-05 05:00:00
        * 3次実行
            * 2024-01-05 08:00:00
        * 4次実行
            * 2024-01-05 12:00:00
